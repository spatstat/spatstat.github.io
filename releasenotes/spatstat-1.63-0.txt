# RELEASE NOTES

## spatstat 1.63-0

### 23 January 2020

   

### OVERVIEW

 * Compute minimum or maximum nearest-neighbour distance between  
    each pair of types in a multitype point pattern.

 * Important bug fix in simulations of the multitype hard core process.

 * Numerous improvements and bug fixes.

 * Deprecated functions have been removed.

 * Version nickname: "Trees in space"

### SIGNIFICANT USER-VISIBLE CHANGES

 * minnndist, maxnndist  
    New argument 'by' makes it possible to find the minimum or maximum  
    nearest neighbour distance between each pair of possible types  
    in a multitype pattern.

 * beachcolours  
    If 'sealevel' lies outside 'srange', then 'srange' will be extended  
    to include it (without a warning).

 * split<-.ppp  
    The default for argument 'un' in 'split<-.ppp'   
    now agrees with the default for the same argument in 'split.ppp'.

 * lineardisc  
    New argument 'add'.  
    Default plotting behaviour has changed.

 * rmh, rmh.default  
    The printed output of the debugger (invoked by snoop=TRUE)  
    has been improved.

 * plot.owin  
    New argument 'use.polypath' controls how to plot  
    a filled polygon when it has holes.

 * plot.profilepl  
    This function has now been documented, and the graphics improved.

 * erode.owin, dilate.owin  
    These deprecated functions have now been deleted  
    (replaced by erosion.owin and dilation.owin)

 * delaunay.distance, delaunay.network  
    These deprecated functions have now been deleted  
    (replaced by delaunayDistance, delaunayNetwork)

 * dirichlet.edges, dirichlet.network, dirichlet.vertices, dirichlet.weights  
    These deprecated functions have now been deleted  
    (replaced by dirichletEdges, dirichletNetwork,  
    dirichletVertices, dirichletWeights)

### BUG FIXES

 1. rmh, simulate.ppm, MultiHard  
     Simulated realisations of the multitype hard core model  
     were completely incorrect (the interaction was effectively removed,  
     changing the model into a Poisson process).  
     Fixed.

 2. kppm, AIC  
     For kppm models fitted with method='clik2', the resulting value of logLik()  
     was equal to 1/2 of the correct value. This would have affected  
     model comparison using AIC, and model selection using step().  
     Fixed.

 3. hyperframe  
     Did not correctly handle date-time values (columns of class 'Date', etc).  
     Fixed

 4. rlpp  
     The resulting pattern was unmarked even when it should have been multitype.  
     Fixed.

 5. idw  
     Estimates were zero if 'se=TRUE' and 'power != 2' and 'at="pixels"'.  
     Fixed.

 6. model.matrix.mppm  
     Sometimes returned a matrix with the wrong number of rows.  
     Fixed.

 7. nncross.ppp  
     Format of output was incorrect if X was an empty pattern.  
     Fixed.

 8. rmh, rmh.default  
     For a marked point process, the debugger did not display the marks.  
     (The rmh debugger is invoked by calling rmh with snoop=TRUE).  
     Fixed.

 9. pairs.im, pairs.linim  
     The argument 'labels' was sometimes ignored.  
     Fixed.

10. as.im.data.frame  
     Results were incorrect for factor-valued data.  
     Fixed.

11. relrisk.ppp  
     Crashed if there were more than 2 types of points  
     and method = "leastsquares" or "weightedleastsquares".  
     Fixed.

12. as.im.nnfun  
     Crashed when applied to a function generated by nnfun.psp.  
     Fixed.

13. diagnose.ppm  
     Crashed for some models with an error message from 'beachcolours'.  
     Fixed.

14. predict.rho2hat  
     Crashed if one of the original covariates was a function  
     rather than an image.  
     Fixed.

15. lineardisc  
     Crashed in some graphics environments.  
     Fixed.

16. lineardisc  
     Crashed if the network segments had marks.  
     Fixed.

17. rmh  
     Crashed for multitype models if 'nsave' was specified.  
     Fixed.

18. vcov.mppm, simulate.mppm  
     Crashed for multitype models with a hardcore interaction component.  
     Fixed.

19. effectfun  
     Crashed if 'covname' was not the name of a covariate appearing in  
     the model and was not one of the reserved names 'x', 'y', 'marks'.  
     Fixed.
